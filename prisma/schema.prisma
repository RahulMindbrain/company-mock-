datasource db {
  provider = "postgresql"
  url      = env("DB_URL")
}

generator client {
  provider = "prisma-client-js"
}

enum CategoryStatus {
  INACTIVE @map("0")
  ACTIVE   @map("1")
}

model Company {
  id              Int       @id @default(autoincrement())
  
  companyName     String?
  websiteUrl      String?
  printName       String?
  billPrefix      String?          

  beginningDate   DateTime?
  commencingFrom  DateTime?

  addressLine1    String?
  addressLine2    String?

  country         String?
  state           String?

  contactNo1      String?
  contactNo2      String?

  email           String? @unique
  website         String?

  gstNo           String?
  panNo           String?
  vatNo           String?
  fax             String?

  lightLogo       String?        
  darkLogo        String?     

  plans           Plan[]
  admins          Admin[] 

  createdBy  String?
  updatedBy  String?

  createdAt       DateTime  @default(now())
  updatedAt       DateTime  @updatedAt

  @@index([companyName])
  @@index([email])
  @@index([gstNo])
}


model Plan{
  id Int  @id @default(autoincrement())
  companyId        Int? 
  company          Company?  @relation(fields: [companyId], references: [id])
  name             String?
  price            Float?
  BV               Float?
  description      Json?
  isActive         Boolean?
  tax              String?
  config           String?

  createdAt       DateTime  @default(now())
  updatedAt       DateTime  @updatedAt
}

model Admin {
  id                       Int             @id @default(autoincrement())
  companyId                Int?
  company                  Company?        @relation(fields: [companyId], references: [id])
  
  firstname                String?
  lastname                 String?
  email                    String?         @unique

  countrycode              String?
  mobno1                   String?
  mobno2                   String?

  pinno                    String?
  countryname              String?
  statename                String?
  address                  String?

  password                 String?

  profileimg               String?
  admintype                String?

  walletbalance            Float             @default(0)
  totalwalletadd           Float             @default(0)
  totalwithdraw            Float             @default(0)
  totaltransferwallet      Float             @default(0)

  status                   Boolean           @default(true)

  createdBy                String?
  updatedBy                String?

  createdAt                DateTime          @default(now())
  updatedAt                DateTime          @updatedAt

  sessions                 AdminSession[]
  categoriesCreated        Category[]        @relation("CreatedCategories")
  categoriesUpdated        Category[]        @relation("UpdatedCategories")
  BrandCreatedBy           Brand[]           @relation("BrandCreated")
  BrandUpdatedBy           Brand[]           @relation("BrandUpdated")

  @@index([companyId])
  @@index([status])
  @@index([admintype])
}

model AdminSession {
  id         Int       @id @default(autoincrement())
  adminId    Int
  admin      Admin     @relation(fields: [adminId], references: [id])
  userAgent  String?
  ipAddress  String?
  valid      Boolean   @default(true)
  createdAt  DateTime  @default(now())
  updatedAt  DateTime  @updatedAt
}


model Category {
  id            Int              @id @default(autoincrement())
  categoryname  String?
  description   Json?

  status        CategoryStatus   @default(ACTIVE)

  createdBy     Int?
  createdByUser Admin?           @relation("CreatedCategories", fields: [createdBy], references: [id])

  updatedBy     Int?
  updatedByUser Admin?           @relation("UpdatedCategories", fields: [updatedBy], references: [id])

  createdAt     DateTime         @default(now())
  updatedAt     DateTime         @updatedAt
}


model Brand{
  id               Int              @id @default(autoincrement())
  brandname        String?  
  status           CategoryStatus   @default(ACTIVE) 

  createdById      Int?
  createdBy        Admin?           @relation("BrandCreated", fields: [createdById], references: [id])

  updatedById      Int?
  updatedBy        Admin?           @relation("BrandUpdated", fields: [updatedById], references: [id])

  createdAt        DateTime         @default(now())
  updatedAt        DateTime         @updatedAt

}
